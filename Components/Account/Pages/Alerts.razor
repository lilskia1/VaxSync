@page "/alerts"
@using VaxSync.Web.Components.Alerts
@using MudBlazor

<PageTitle>Vaccination Alerts</PageTitle>

<MudGrid>
  <MudItem xs="12" sm="6" md="4">
    <MudSelect T="AlertsList.AlertFilter" Label="Filter" @bind-Value="_filter">
      <MudSelectItem T="AlertsList.AlertFilter" Value="@(AlertsList.AlertFilter.All)">All</MudSelectItem>
      <MudSelectItem T="AlertsList.AlertFilter" Value="@(AlertsList.AlertFilter.Imminent)">⚠️ Due Soon</MudSelectItem>
      <MudSelectItem T="AlertsList.AlertFilter" Value="@(AlertsList.AlertFilter.Overdue)">❗ Overdue</MudSelectItem>
    </MudSelect>
  </MudItem>

  <MudItem xs="12" class="mt-4">
    <AlertsList Filter="_filter"
                ScopeToCurrentUser="true"
                ShowActions="true"
                OnView="GoToDetails"
                OnDownload="DownloadPdf" />
  </MudItem>
</MudGrid>

@code {
  private AlertsList.AlertFilter _filter = AlertsList.AlertFilter.All;

  private void GoToDetails(string studentId)
    => Navigation.NavigateTo($"/student-details/{studentId}");

  private void DownloadPdf(string studentId)
    => Navigation.NavigateTo($"/student-report/{studentId}");

  [Inject] private NavigationManager Navigation { get; set; } = default!;
}
